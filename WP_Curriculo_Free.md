# WP-Curricul Vitea Free <= 6.3 - Arbitrary File Upload
The plugin WP-Curriculo Vitae Free suffers the vulnerability to allow an arbitrary file uploaded from the remote attacker. 
It supports a registration form that allows the remote visitor to register their personal information on the plugin user's website.
The user with admin privilege could use the shortcode [formCadastro] in one page and the information about the register, including 
the profile picture and resume, will be stored in the local directory without any restriction in file extension.

Here is [video](https://youtu.be/oAUAwoMF00Q) that proof the vulnerability and present exploit process.  

In order to provide the file uploading functionality, It uses move_uploaded_file() function to store the file from the 
register but it failed to check file extension before use this function.
```
<?php
$uploaddir = dirname(__FILE__) . "/../../../../../wp-content/uploads/curriculos/";
if ($_FILES['curriculo']['name']) {
	$tipoArquivo = explode(".", $_FILES['curriculo']['name']);
	if (@$_SESSION['tipoF'] == "site") {
		@unlink("wp-content/uploads/curriculos/" . @$_SESSION['curriculo']);
		$_SESSION['curriculo'] = $nome2 . "." . $tipoArquivo[1];
	} elseif (@$_POST['tipoF'] == "admin") {
		@unlink("wp-content/uploads/curriculos/" . @$dado['curriculo']);
		$dado['curriculo'] = $nome2 . "." . $tipoArquivo[1];
	}
	$curriculo = $nome2 . "." . $tipoArquivo[1];
	move_uploaded_file($_FILES['curriculo']['tmp_name'], $uploaddir . $curriculo);
}
```