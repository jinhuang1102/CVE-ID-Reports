# Event Banner <= 1.3 Authenticated Arbitrary File Upload leading to RCE

The plugin Event Banner did not verify the uploaded image file, 
allowing admin privilege accounts to be able to upload arbitrary files, .exe, .php, or others executable files, leading to RCE.

[Proof of Video](https://youtu.be/DB-WRzKO-14)

The developer only concern the functionality of the file uploading but leave the sanitization to the admin user.
```php
<?php 
// in the file free-event-banner/views/admin_setting.php line:29 - 47

if(!empty($_FILES['image'])){
 /* rename the file name */
 $ext = substr($_FILES['image']['name'], strpos($_FILES['image']['name'], '.'));
 $new_name = $_POST['event']['date'].$ext;
 /* upload image */
 if(move_uploaded_file($_FILES['image']['tmp_name'], $target_path.'/'.$new_name)) {
   /* success upload handler */
 } else {
   /* error upload handler */
 }
 /* save to database */
 $wpdb->insert($wpdb->prefix.'event_banner', array(
   'date' => $_POST['event']['date'],
   'name' => $_POST['event']['name'],
   'description' => $_POST['event']['description'],
   'status' => $_POST['event']['status'],
   'img_src' => $new_name
 ));
}
```

